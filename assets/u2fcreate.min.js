function magic(){function e(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),document.getElementById(t).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+e+"</p></div>")}function t(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),document.getElementById(t).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+e+"</p></div>")}function n(e){e?(o.classList.add("is-active"),d.setAttribute("disabled",""),c.removeAttribute("hidden")):(o.classList.remove("is-active"),d.removeAttribute("disabled"),c.setAttribute("hidden",""))}function r(){if(n(!1),null!==this.response&&200===this.status)if(this.response.ok){var r=i.querySelector("tr.no-items");r&&r.parentNode.removeChild(r),i.insertAdjacentHTML("beforeend",this.response.row),t(this.response.message,"new-key"),wwU2F.sigs=this.response.sigs,wwU2F.request=this.response.request,a.value=""}else e(this.response.message,"new-key");else e(wwU2F.serverError,"new-key")}var s=document.getElementById("new-key-form"),o=s.querySelector(".spinner"),i=document.getElementById("the-list"),d=document.getElementById("submit-button"),a=document.getElementById("key-name"),c=document.getElementById("hint");s.addEventListener("submit",function(t){t.preventDefault(),s.reportValidity()&&(n(!0),function(){var t=document.querySelector("#new-key + .notice");t&&t.parentNode.removeChild(t),(t=document.querySelector("#registered-keys + .notice"))&&t.parentNode.removeChild(t);var s=[{version:wwU2F.request.version,challenge:wwU2F.request.challenge}];u2f.register(wwU2F.request.appId,s,wwU2F.sigs,function(t){if(t.errorCode)return wwU2F.errors[t.errorCode],e(wwU2F.errors[t.errorCode],"new-key"),void n(!1);var s=encodeURIComponent(a.value),o=new XMLHttpRequest;o.addEventListener("load",r),o.open("POST",wwU2F.ajax_url),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.responseType="json",o.send("action=wwu2f_register&data="+encodeURIComponent(JSON.stringify(t))+"&name="+s)})}())}),document.querySelector("table.widefat > tbody").addEventListener("click",function(n){for(var r=n.target;null!==r&&"BUTTON"!==r.tagName.toUpperCase()&&-1!==r.className.indexOf("revoke-button");)r=r.parentNode;if(r&&confirm(wwU2F.revconfirm)){var s=r.dataset.handle,o=r.dataset.nonce,d=new XMLHttpRequest;d.addEventListener("load",function(){if(null!==this.response&&200===this.status)if(this.response.ok){for(t(this.response.message,"registered-keys");null!==r&&"TR"!==r.tagName.toUpperCase();)r=r.parentNode;if(r&&r.parentNode.removeChild(r),!i.getElementsByTagName("tr").length){var n=document.getElementById("tpl-empty").textContent;i.insertAdjacentHTML("beforeend",n)}wwU2F.sigs=this.response.sigs}else e(this.response.message,"registered-keys");else e(wwU2F.serverError,"registered-keys")}),d.open("POST",wwU2F.ajax_url),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.responseType="json",d.send("action=wwu2f_revoke&handle="+encodeURIComponent(s)+"&_wpnonce="+o)}}),"undefined"!=typeof u2f&&u2f.register||e(wwU2F.noSupport,"new-key")}document.addEventListener("DOMContentLoaded",function(){if("undefined"!=typeof u2f&&u2f.register)magic();else{var e=document.createElement("script");e.setAttribute("src",wwU2F.u2f_api),e.setAttribute("async",""),e.addEventListener("load",magic),e.addEventListener("error",magic),document.head.appendChild(e)}});
//# sourceMappingURL=u2fcreate.min.js.map
