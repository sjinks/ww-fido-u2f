function magic(){var t=document.getElementById("new-key-form"),n=t.querySelector(".spinner"),o=document.getElementById("the-list"),r=document.getElementById("submit-button"),s=document.getElementById("key-name"),i=document.getElementById("hint");function d(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),document.getElementById(t).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+e+"</p></div>")}function a(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),document.getElementById(t).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+e+"</p></div>")}function c(e){e?(n.classList.add("is-active"),r.setAttribute("disabled",""),i.removeAttribute("hidden")):(n.classList.remove("is-active"),r.removeAttribute("disabled"),i.setAttribute("hidden",""))}function u(){if(c(!1),null!==this.response&&200===this.status)if(this.response.ok){var e=o.querySelector("tr.no-items");e&&e.parentNode.removeChild(e),o.insertAdjacentHTML("beforeend",this.response.row),a(this.response.message,"new-key"),wwU2F.sigs=this.response.sigs,wwU2F.request=this.response.request,s.value=""}else d(this.response.message,"new-key");else d(wwU2F.serverError,"new-key")}t.addEventListener("submit",function(e){e.preventDefault(),t.reportValidity()&&(c(!0),function(){var e=document.querySelector("#new-key + .notice");e&&e.parentNode.removeChild(e),(e=document.querySelector("#registered-keys + .notice"))&&e.parentNode.removeChild(e);var t=[{version:wwU2F.request.version,challenge:wwU2F.request.challenge}];u2f.register(wwU2F.request.appId,t,wwU2F.sigs,function(e){if(e.errorCode){var t=wwU2F.errors[e.errorCode]||1;return d(wwU2F.errors[t],"new-key"),void c(!1)}var n=encodeURIComponent(s.value),r=new XMLHttpRequest;r.addEventListener("load",u),r.open("POST",wwU2F.ajax_url),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.responseType="json",r.send("action=wwu2f_register&data="+encodeURIComponent(JSON.stringify(e))+"&name="+n)})}())}),document.querySelector("table.widefat > tbody").addEventListener("click",function(e){for(var t=e.target;null!==t&&"BUTTON"!==t.tagName.toUpperCase()&&-1!==t.className.indexOf("revoke-button");)t=t.parentNode;if(t&&confirm(wwU2F.revconfirm)){var n=t.dataset.handle,r=t.dataset.nonce,s=new XMLHttpRequest;s.addEventListener("load",function(){if(null!==this.response&&200===this.status)if(this.response.ok){for(a(this.response.message,"registered-keys");null!==t&&"TR"!==t.tagName.toUpperCase();)t=t.parentNode;if(t&&t.parentNode.removeChild(t),!o.getElementsByTagName("tr").length){var e=document.getElementById("tpl-empty").textContent;o.insertAdjacentHTML("beforeend",e)}wwU2F.sigs=this.response.sigs}else d(this.response.message,"registered-keys");else d(wwU2F.serverError,"registered-keys")}),s.open("POST",wwU2F.ajax_url),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.responseType="json",s.send("action=wwu2f_revoke&handle="+encodeURIComponent(n)+"&_wpnonce="+r)}}),"undefined"!=typeof u2f&&u2f.register||d(wwU2F.noSupport,"new-key")}document.addEventListener("DOMContentLoaded",function(){if("undefined"!=typeof u2f&&u2f.register)magic();else{var e=document.createElement("script");e.setAttribute("src",wwU2F.u2f_api),e.setAttribute("async",""),e.addEventListener("load",magic),e.addEventListener("error",magic),document.head.appendChild(e)}});
//# sourceMappingURL=u2fcreate.min.js.map
