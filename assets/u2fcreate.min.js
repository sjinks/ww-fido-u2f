function magic(){var r=document.getElementById.bind(document),t=r("new-key-form"),n=t.querySelector(".spinner"),s=r("the-list"),o=r("submit-button"),i=r("key-name"),a=r("hint");function d(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),r(t).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+e+"</p></div>")}function c(e,t){var n=document.querySelector("#"+t+" + .notice");n&&n.parentNode.removeChild(n),r(t).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+e+"</p></div>")}function u(){var e=document.querySelector("#new-key + .notice");e&&e.parentNode.removeChild(e),(e=document.querySelector("#registered-keys + .notice"))&&e.parentNode.removeChild(e)}function l(e){e?(n.classList.add("is-active"),o.setAttribute("disabled",""),a.removeAttribute("hidden")):(n.classList.remove("is-active"),o.removeAttribute("disabled"),a.setAttribute("hidden",""))}function p(){var e;(l(!1),null!==this.response&&200===this.status)?this.response.ok?((e=s.querySelector("tr.no-items"))&&e.parentNode.removeChild(e),s.insertAdjacentHTML("beforeend",this.response.row),c(this.response.message,"new-key"),wwU2F.sigs=this.response.sigs,wwU2F.request=this.response.request,i.value=""):d(this.response.message,"new-key"):d(wwU2F.serverError,"new-key")}function m(){this.tgt.querySelector(".spinner").classList.remove("is-active"),null!==this.response&&200===this.status?this.response.ok?(c(this.response.message,"registered-keys"),function(e){for(;null!==e&&"TR"!==e.tagName.toUpperCase();)e=e.parentNode;e&&e.parentNode.removeChild(e)}(this.tgt),function(){if(!s.getElementsByTagName("tr").length){var e=r("tpl-empty").textContent;s.insertAdjacentHTML("beforeend",e)}}(),wwU2F.sigs=this.response.sigs):d(this.response.message,"registered-keys"):d(wwU2F.serverError,"registered-keys")}t.addEventListener("submit",function(e){e.preventDefault(),t.reportValidity()&&(l(!0),function(){u();var e=[{version:wwU2F.request.version,challenge:wwU2F.request.challenge}];u2f.register(wwU2F.request.appId,e,wwU2F.sigs,function(e){if(e.errorCode){var t=wwU2F.errors[e.errorCode]||1;return d(wwU2F.errors[t],"new-key"),void l(!1)}var n=encodeURIComponent(i.value),r=new XMLHttpRequest;r.addEventListener("load",p),r.open("POST",ajaxurl),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.responseType="json",r.send("action=wwu2f_register&data="+encodeURIComponent(JSON.stringify(e))+"&name="+n)})}())}),document.querySelector("table.widefat > tbody").addEventListener("click",function(e){for(var t=e.target;null!==t&&(!t.tagName||"BUTTON"!==t.tagName.toUpperCase()||-1===t.className.indexOf("revoke-button"));)t=t.parentNode;if(t&&confirm(wwU2F.revconfirm)){var n=t.dataset.handle,r=t.dataset.nonce,s=new XMLHttpRequest;s.tgt=t,s.addEventListener("load",m);var o=t.querySelector(".spinner");o.style.float="none",o.style.margin=0,o.classList.add("is-active"),u(),s.open("POST",ajaxurl),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.responseType="json",s.send("action=wwu2f_revoke&handle="+encodeURIComponent(n)+"&_wpnonce="+r)}}),"undefined"!=typeof u2f&&u2f.register||d(wwU2F.noSupport,"new-key")}document.addEventListener("DOMContentLoaded",function(){if("undefined"!=typeof u2f&&u2f.register)magic();else{var e=document.createElement("script");e.setAttribute("src",wwU2F.u2f_api),e.setAttribute("async",""),e.addEventListener("load",magic),e.addEventListener("error",magic),document.head.appendChild(e)}});
//# sourceMappingURL=u2fcreate.min.js.map
